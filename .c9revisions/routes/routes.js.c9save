{"ts":1375380248686,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var mit = require(\"../lib/mit.js\");\nvar fs = require(\"fs\");\n\nmodule.exports = {\n    getIndex: function(request, response){\n        response.render('index');    \n    },\n    getLite: function(request, response){\n        response.render('lite');    \n    },\n    getLiteResults: function(request, response){\n        response.render('literesults');    \n    },\n    getPartial: function(request, response){\n        response.render('partial');    \n    },\n    \n    getSubstantial: function(request, response) {\n        response.render('substantial');\n    },\n    \n    getComprehensive: function(request, response) {\n        response.render('comprehensive');\n    },\n    //Submits\n    liteanalysis: function(request, response) {\n        var buildingName = request.body.building.building_name;\n        var date = request.body.utility.utility_startdate;\n        var electricity = request.body.utility.utility_electric;\n        var ngas = request.body.utility.utility_gas;\n        \n        var insFileName = buildingName + '.ins'\n        var datFileName = buildingName + '.dat'\n        var time = new Date().getTime();\n        var path = './lite/' + buildingName + time + '/';\n        \n        fs.mkdirSync(path);\n        liteins.imtins(insFileName, datFileName, path);\n         \n        fs.readFile(path + insFileName, function(error, content) {\n                if (error) {\n                    response.writeHead(500);\n                    response.end();\n                }\n                else {\n                    response.writeHead(200, {\n                        'Content-Type': 'text/plain'\n                    });\n                    response.end(content, 'utf-8');\n                }\n            });\n    },\n    partialanalysis: function(request, response){\n        var buildingName = request.body.building.building_name;\n        var stringBuilding = JSON.stringify(request.body.building);\n        var stringOccupancy = JSON.stringify(request.body.occupancy);\n        var stringMaterials = JSON.stringify(request.body.materials);\n        var stringMechanical = JSON.stringify(request.body.mechanical);\n        var stringRoom = JSON.stringify(request.body.room);\n        var string = stringBuilding  + '<br/>' + stringOccupancy  + '<br/>' + stringMaterials + '<br />' + stringMechanical + '<br />' + stringRoom;\n        var route = \"./views/\";\n        var fileName = route + buildingName + '.ejs' ;\n        fs.writeFileSync(fileName, string);\n        response.render(buildingName);\n        \n    },\n    \n    \n};\n"]],"start1":0,"start2":0,"length1":0,"length2":2500}]],"length":2500}
